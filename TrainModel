import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.naive_bayes import MultinomialNB
from sklearn.pipeline import make_pipeline
import pickle

# Load the dataset from the CSV file
file_path = r'C:\Users\User\Downloads\Applied AI\archive (9)\bbc-text.csv'
df = pd.read_csv(file_path)

# Create a model pipeline
model = make_pipeline(TfidfVectorizer(), MultinomialNB())

# Train the model
model.fit(df['text'], df['category'])

# Save the model
with open('text_classifier_bbc.pkl', 'wb') as file:
    pickle.dump(model, file)

print("Model training completed and saved as 'text_classifier_bbc.pkl'")
